{% comment %}
  sections/square-image.liquid
{% endcomment %}

<div
  class="square-image-border"
  style="
    --banner-height: {{ section.settings.banner_height | default: 30 }}px;
    --banner-pos-x: {{ section.settings.banner_pos_x | default: 50 }}%;
    --banner-pos-y: {{ section.settings.banner_pos_y | default: 50 }}%;
  "
>
  <div class="square-image-container">
    {% if section.settings.link != blank %}
      <a class="square-image-link" href="{{ section.settings.link }}">
    {% endif %}

    {% if section.settings.image != blank %}
      {{ section.settings.image
        | image_url: width: 2400
        | image_tag: class: 'square-image', alt: section.settings.alt_text }}
    {% else %}
      <div class="square-image-placeholder">
        Upload an image in the section settings
      </div>
    {% endif %}

    {% if section.settings.link != blank %}
      </a>
    {% endif %}
  </div>
</div>

{% stylesheet %}
/* Optional: remove theme top spacing on homepage */
.template-index main#MainContent,
.template-index #MainContent {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* TRUE full-bleed edge-to-edge */
.square-image-border {
  width: 100vw;                        /* exact screen width */
  max-width: 100%;
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
  background: transparent;
  border: 0;
  box-sizing: border-box;
  overflow: hidden;                    /* prevents any tiny overflow */
}

.square-image-container {
  width: 100%;
}

/* Make the link full width too */
.square-image-link {
  display: block;
  width: 100%;
}

/* Banner image fills entire area */
.square-image {
  width: 100%;
  height: var(--banner-height);
  display: block;

  object-fit: cover;
  object-position: var(--banner-pos-x, 50%) var(--banner-pos-y, 50%);

  border: 0;
}

/* Placeholder same size */
.square-image-placeholder {
  width: 100%;
  height: var(--banner-height);
  background-color: #d7ebd3;
  color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-size: 1rem;
}
{% endstylesheet %}

{% schema %}
{
  "name": "Square image",
  "settings": [
    { "type": "image_picker", "id": "image", "label": "Banner image" },
    { "type": "text", "id": "alt_text", "label": "Alt text", "default": "Banner image" },
    { "type": "url", "id": "link", "label": "Optional link" },
    { "type": "range", "id": "banner_height", "label": "Banner height (px)", "min": 30, "max": 700, "step": 10, "default": 90 },
  ],
  "presets": [{ "name": "Square image" }]
}
{% endschema %}
